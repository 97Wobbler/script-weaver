# Script Weaver - TODO List

## 🎯 MVP 목표
웹 기반 Dialogue Editor (프론트엔드-Only) - 컨텐츠-키 분리 아키텍처 기반
> **핵심**: 기획자는 실제 텍스트만 입력, 로컬라이징 키는 백그라운드 자동 관리

---

## ✅ 완료된 작업

### 1-2주차: 기본 시스템 구축 ✅
- **환경 설정**: React + Vite + TypeScript, Tailwind CSS 4.x, React Flow, Zustand
- **기본 UI**: 에디터 레이아웃, Canvas, 툴바, 속성 패널
- **노드 시스템**: TextNode/ChoiceNode 생성, 편집, 위치 저장, localStorage 지속성
- **연결 시스템**: React Flow Handle 기반 드래그 연결

### 3주차: Import/Export 및 검증 시스템 ✅
- **Export/Import**: JSON/CSV 형식 지원, 유연한 스키마 적용
- **검증 시스템**: Zod 기반 스키마 검증, 댕글링 참조 감지 및 정리
- **localStorage 자동 저장**: Zustand persist 구현

### 4주차: 컨텐츠-키 분리 아키텍처 ✅ **핵심 완료!**
- **LocalizationStore 구현**: key-value 매핑 저장소, 자동 키 생성 시스템
- **실제 텍스트 기반 UI**: PropertyPanel, 노드 미리보기 모두 실제 텍스트 표시
- **키 자동 생성**: 숫자 ID 기반 (`npc_1`, `line_1`, `choice_1` 형태)
- **중복 텍스트 감지**: 동일 텍스트 시 기존 키 재사용 로직
- **키 편집 시스템**: 단순화된 워크플로우 (항상 "모든 위치 함께 변경")
- **일괄 수정 기능**: 같은 키를 사용하는 모든 텍스트 동시 수정
- **Export/Import v2.0**: LocalizationStore 포함한 새로운 데이터 구조

### QA 및 버그 수정 ✅ **9개 주요 버그 해결**
- **중복 텍스트 감지 로직 문제** → 우선 실행으로 수정
- **노드 생성 시 기본값** → 빈 문자열로 변경
- **키 편집 후 UI 동기화** → PropertyPanel 리렌더링 추가
- **한국어 입력 시 글자 반복** → IME 이벤트 처리 추가
- **키 삭제 로직** → 단일 사용 키만 삭제하도록 수정
- **선택지 생성/삭제 시 키 관리** → LocalizationStore 정리 로직 추가
- **키 편집 시 줄바꿈 처리** → 화자/선택지 줄바꿈 금지

---

## 📋 현재 상태

### 프로젝트 현황 🎉
- ✅ **4주차 핵심 완료 100%**: 컨텐츠-키 분리 아키텍처 완성
- ✅ **LocalizationStore**: 키 자동 생성, 중복 감지, 일괄 수정 완료
- ✅ **실제 텍스트 기반 UI**: PropertyPanel, 노드 미리보기 완료
- ✅ **QA 완료**: 9개 주요 버그 모두 해결

---

## 📋 예정된 작업

### Phase 1: MVP 완성 🔥 **최우선**
- [ ] **AC-02 구현**: 선택지별 "+" 버튼으로 해당 선택지의 nextNodeKey로 새 노드 자동 연결
  - Choice 노드에서 각 선택지 오른쪽에 "+" 버튼 추가
  - 클릭 시 해당 선택지의 nextNodeKey로 새 노드 자동 생성·연결
  - 노드 배치: 마지막 생성 노드 기준 Y축 + 노드높이 + 10px 오프셋
- [ ] **최종 QA**: 전체 AC 항목 재검증 및 회귀 버그 체크
  - AC-01~AC-06 전체 재테스트
  - 수정된 9개 버그들 정상 동작 확인
  - 새로운 회귀 버그 체크
- [ ] **MVP 배포**: GitHub Pages 설정 및 첫 배포
  - GitHub Pages 설정
  - 배포 스크립트 작성
  - 첫 MVP 배포 완료

### Phase 2: 사용성 개선 🟡 **중요**
- [ ] **성능 최적화**: 100개 노드 제한 구현
  - 노드 생성 시 개수 제한 체크
  - 제한 초과 시 경고 메시지 표시
- [ ] **기본 접근성**: 키보드 탐색, 반응형 디자인
  - Tab/Enter 키보드 탐색 지원
  - 모바일/태블릿 반응형 레이아웃
  - ARIA 라벨 및 접근성 개선
- [ ] **UX-01 최종 결정**: 중복 텍스트 모달 처리 방식
  - 현재: "기존 키 사용" vs "새 키 생성" 선택 모달
  - 검토: 토스트 메시지로 간단히 "기존 키 자동 배정" 알림만 표시

### Phase 3: 폴리싱 🟢 **선택적**
- [ ] **시각적 개선**: 애니메이션 및 트랜지션 추가
  - 노드 생성/삭제 애니메이션
  - 연결 생성 시 시각적 피드백
  - 부드러운 트랜지션 효과
- [ ] **성능 튜닝**: 빌드 최적화 및 번들 크기 최적화
  - Vite 빌드 설정 최적화
  - 번들 크기 분석 및 최적화
  - 로딩 성능 개선

---

## 🔮 향후 확장 계획 (Post-MVP)

### 우선순위 기능 (중요도 순)
1. **G-01: 로컬라이징 전용 탭** - key-value 매핑 직접 관리 (사용자 요청 높음)
2. **G-02: 플로우 시뮬레이터** - 플레이 모드 (기획자 검증 도구)
3. **G-06: InputDialogue 노드** - 사용자 입력 노드 생성 및 런타임 속성 지원 (기능 완성도)
4. **G-03: 콜백 키 CRUD 페이지** + 검색 (개발자 도구)
5. **G-07: 순환 참조 감지** - 경고 시스템 (안정성)

### 장기 계획
6. **G-04: 커스텀 메타데이터** - 감정, 카메라, SFX 확장 (확장성)
7. **G-05: 버전 관리** - Git, 다중 사용자 협업 (협업 도구)

---

## 📋 기술 정보 요약

### 아키텍처 핵심
- **컨텐츠-키 분리**: 실제 텍스트(기획자) ↔ 로컬라이징 키(개발자) 완전 분리
- **LocalizationStore**: 백그라운드 key-value 매핑 저장소
- **의도적 키 관리**: 타이핑 중 키 생성 안함, 완료 시점에만 처리
- **숫자 ID 기반 키**: `npc_1`, `line_1`, `choice_1` 형태로 충돌 방지

### 주요 제약사항 (MVP)
- 템플릿당 100개 노드 제한
- TextDialogue, ChoiceDialogue만 생성 지원 (InputDialogue는 타입만)
- 서버 없는 SPA, localStorage만 사용
- MVP에서는 순환 참조 허용 (루프 구조 지원)

### Acceptance Criteria 체크리스트
- [x] AC-01: 새 텍스트 노드 추가 → JSON 저장 동일 내용 존재
- [ ] AC-02: 선택지별 "+" 버튼으로 해당 선택지의 nextNodeKey로 새 노드 자동 연결
- [x] AC-03: nextNodeKey 비어있으면 Export 시점 검증
- [x] AC-04: 브라우저 새로고침 후 Canvas 레이아웃 복원
- [x] AC-05: JSON/CSV Export → Import 후 데이터 무손실
- [x] AC-06: 같은 텍스트 입력 → 키 재사용 제안, 키 수정 → 일괄 변경 선택

---

## 📋 메모

### 개발 우선순위
1. **5주차 폴리싱**: UI/UX 개선, 성능 최적화, 최종 QA
2. **MVP 배포**: GitHub Pages 배포 완료
3. **Post-MVP**: 로컬라이징 전용 탭(G-01) 우선 착수

### 주요 레퍼런스
- **PRD**: `document/prd.md` - 전체 프로젝트 사양 및 기술 스택
- **기술 스택**: React + Vite + TypeScript, React Flow, Zustand, Tailwind CSS 4.x, Zod 