# ScriptWeaver - TODO List

## 🎯 MVP 목표

웹 기반 Dialogue Editor (프론트엔드-Only) - 컨텐츠-키 분리 아키텍처 기반

> **핵심**: 기획자는 실제 텍스트만 입력, 로컬라이징 키는 백그라운드 자동 관리

---

## 프로덕트 장기 로드맵

-   [x] **내부 MVP (Dagre)** - 3단계 해결 방식 + 3가지 정렬 기능 구현 **완료!**
-   [x] **레이아웃 엔진 추상화** - 인터페이스 분리, 플러그인 아키텍처 구축 **완료!**
-   [ ] **플러그인/웹워커화** - 백그라운드 처리, 성능 최적화
-   [ ] **ELK Pro 기능** - 복잡한 그래프, 고급 레이아웃 알고리즘
-   [ ] **실시간 협업·권한 관리** - 다중 사용자 동시 편집
-   [ ] **상품화 (Free/Pro 플랜)** - 기능별 티어링, 수익화 모델

---

## **Post-MVP 확장 기능** 🔮 **장기 계획**

### 우선순위 기능 (중요도 순)

1. **G-01: 로컬라이징 전용 탭** - key-value 매핑 직접 관리 (사용자 요청 높음)
2. **G-02: 플로우 시뮬레이터** - 플레이 모드 (기획자 검증 도구)
3. **G-06: InputDialogue 노드** - 사용자 입력 노드 생성 및 런타임 속성 지원 (기능 완성도)
4. **G-03: 콜백 키 CRUD 페이지** + 검색 (개발자 도구)

### 장기 계획

5. **G-04: 커스텀 메타데이터** - 감정, 카메라, SFX 확장 (확장성)
6. **G-05: 버전 관리** - Git, 다중 사용자 협업 (협업 도구)
7. **G-07: 히스토리 관리** - 작업 히스토리 diff 방식 기반으로 되돌리기/다시실행

---

## 📋 현재 상태

### 프로젝트 현황 🎉 **Phase 2 완료!**

-   ✅ **Phase 1 완료 100%**: 컨텐츠-키 분리 아키텍처 기반 MVP 완성
-   ✅ **Phase 2 완료 100%**: 노드 배치 고도화 + 핵심 편집 기능 개선 완료
-   ✅ **LocalizationStore**: 키 자동 생성, 중복 감지, 일괄 수정, 전역 토스트 관리
-   ✅ **레이아웃 엔진 시스템**: 3단계 파이프라인 + 3가지 정렬 기능 완성

### 🎯 **다음 단계**: Phase 3 폴리싱 또는 Post-MVP 확장 기능

---

## 📋 진행 중인 작업

### **G-01: 로컬라이징 전용 탭 기능 개발** 🔥 **진행 중 - 2025/06/24 21:16**

**배경**: 현재 CSV 내보내기로 지원하는 dialogue.csv와 localization.csv 데이터를 관찰하고 편집할 수 있는 전용 탭이 필요함. 기획자가 키값을 한눈에 보고 한번에 편집할 수 있어야 하며, 추후 로컬라이제이션 초벌 작업도 가능하도록 확장 가능해야 함.

**선택된 접근 방법**: 탭 기반 분리 UI (A 방식)
- 메인 에디터 탭과 로컬라이징 탭을 분리
- 로컬라이징 탭 내부에 dialogue.csv, localization.csv 두 개의 서브탭
- 탭 전환 시점에 데이터 동기화 (실시간 동기화 불필요)
- 스프레드시트 형태의 편집 UI

**구현할 기능**:
- [x] 탭 기반 UI 구조 구현 (메인 에디터 / 로컬라이징) ✅ **완료 - 2025/06/24 11:30**
- [x] 로컬라이징 탭 내 서브탭 구현 (dialogue.csv / localization.csv) ✅ **완료 - 2025/06/24 11:30**
- [x] 좌측 사이드바 탭별 내용 변경 ✅ **완료 - 2025/06/24 11:45**
- [x] 스프레드시트 형태의 편집 테이블 구현 ✅ **완료 - 2025/06/24 12:00**
- [x] 키값 및 한글 원문 텍스트 편집 기능 ✅ **완료 - 2025/06/24 12:00**
- [x] 키 추가/삭제 기능 ✅ **완료 - 2025/06/24 12:00**
- [x] Dialogue CSV 편집 테이블 구현 ✅ **완료 - 2025/06/24 12:15**
- [x] 개행문자 처리 기능 ✅ **완료 - 2025/06/24 15:47**
- [x] 검색/필터링 기능 ✅ **완료 - 2025/06/24 21:16**
- [x] 되돌리기 기능 ✅ **완료 - 2025/06/24 21:16**
- [x] 유효성 검사 (중복 키 경고 및 작업 취소, 중복 텍스트 경고) ✅ **완료 - 2025/06/24 21:16**
- [x] 탭 전환 시 데이터 동기화 ✅ **완료 - 2025/06/24 21:16**

**완료된 작업**:
- 헤더에 탭과 프로젝트 메뉴 통합 (JSON Import/Export → 프로젝트 저장/열기)
- 좌측 사이드바에서 CSV 내보내기 제거
- 로컬라이징 탭에 CSV 복사 기능 추가
- 탭 전환 기능 구현
- 서브탭 구조 구현 (Dialogue CSV / Localization CSV)
- 좌측 사이드바 탭별 내용 변경 (에디터 탭: 기존 도구, 로컬라이징 탭: LocalizationTools)
- LocalizationTools 컴포넌트 구현 (검색/필터링, 키 관리, 통계, 검색 결과 미리보기)
- Localization CSV 편집 테이블 구현 (인라인 편집, 키/텍스트 수정, 삭제 기능)
- 유효성 검사 구현 (중복 키 체크, 빈 값 체크)
- Dialogue CSV 편집 테이블 구현 (노드 구조 표시, CSV 파싱, 편집 UI)
- 개행문자 처리 기능 완성 (CSV 파싱 시 인용부호 내 개행문자 올바른 처리, 테이블에서 줄바꿈 표시, CSV 복사 시 데이터 구분은 실제 줄바꿈으로 유지하고 대사 내 줄바꿈만 \n으로 변환)
- **Dialogue CSV 편집 기능 완성**: EditorStore와 연동하여 실제 노드 데이터 업데이트 기능 구현
- **검색/필터링 기능 완성**: Localization CSV 탭에 검색 입력창과 필터 드롭다운 추가, 키/텍스트 기반 검색 및 타입별 필터링
- **되돌리기 기능 구현**: "모두 취소" 버튼과 Ctrl+Z 단축키로 편집 중인 모든 항목 취소
- **유효성 검사 기능 구현**: 중복 키, 중복 텍스트, 빈 값 감지 및 경고 표시
- **탭 전환 시 데이터 동기화**: 편집 중인 상태 확인 후 탭 전환 시 경고 및 데이터 동기화

**기술적 고려사항**:
- LocalizationStore와 EditorStore 간 데이터 동기화 ✅ **완료**
- CSV 데이터 구조 기반 테이블 렌더링 ✅ **완료**
- 편집 상태 관리 및 변경사항 추적 ✅ **완료**
- 유효성 검사 로직 구현 ✅ **완료**

**🎉 G-01 로컬라이징 전용 탭 기능 개발 완료!** - 2025/06/24 21:16

**추가 개선사항**:
- [x] **좌측 도구 패널 중복 검색 기능 제거**: Localization CSV 탭에 이미 검색 기능이 구현되어 있어 중복 제거 ✅ **완료 - 2025/06/24 22:00**
- [ ] **좌측 도구 패널 기능 검토 및 개선**: 현재 키 관리, 검증, 통계 기능들이 실제로 필요한지 검토하고, 향후 도구 추가/제거 시 UI 개선 계획 수립

### **좌측 도구 패널 스크롤 기능 추가** ✅ **완료 - 2025/06/24 08:45**

**배경**: 우측 PropertyPanel은 이미 스크롤이 적용되어 있지만, 좌측 도구 패널에는 스크롤이 적용되어 있지 않아 내용이 많아지면 접근할 수 없는 문제가 있음

**선택된 접근 방법**: CSS `overflow-y-auto` 적용
- 좌측 사이드바 전체에 스크롤 적용
- 기존 레이아웃 구조는 그대로 유지
- 내용이 많아지면 전체 사이드바가 스크롤됨

**구현 완료**:
- `App.tsx`의 좌측 사이드바 `<aside>` 태그에 `flex flex-col overflow-y-auto` 클래스 추가
- 기존 스타일링과 레이아웃 유지
- 테스트 완료: 스크롤 기능 정상 작동 확인

---

## 📋 예정된 작업

### **Phase 3: 폴리싱** 🟢 **선택적**

#### UI/UX 세부 개선 ✨ **사용자 경험**

-   [ ] **노드 우클릭 메뉴** - 컨텍스트 메뉴로 빠른 액션 제공 (복사, 삭제, 타입 변환)
-   [ ] **장면 시작 노드 표시** - 시나리오 시작점 시각적 구분
-   [ ] **기본 접근성**: 키보드 탐색, 반응형 디자인
    -   Tab/Enter 키보드 탐색 지원
    -   모바일/태블릿 반응형 레이아웃
    -   ARIA 라벨 및 접근성 개선

#### 시각적 개선 🎨

-   [ ] **애니메이션 및 트랜지션 추가**
    -   노드 생성/삭제 애니메이션
    -   연결 생성 시 시각적 피드백
    -   부드러운 트랜지션 효과

#### 조건부 기능 확장 🔍 **검토 필요**

-   [ ] **InputDialogue 노드 지원** - 사용자 입력 노드 생성 및 런타임 속성
-   [ ] **명시적 종료 노드** - 시나리오 종료점 명확화 (vs 현재 빈 nextNodeKey 방식)

#### 아키텍처 개선

-   [ ] **노드 타입 모듈화**: TextDialogue/ChoiceDialogue 공통 부모 클래스/인터페이스 설계
    -   BaseDialogueNode 추상화로 확장성 확보 (InputDialogue, 커스텀 노드 대비)
    -   노드 생성/검증/직렬화 로직 통합, 타입 안전성 향상
    -   노드 컴포넌트는 시각적 요소만 남기고 논리적 코드는 외부로 이동
-   [ ] **노드 변환 로직 범용화**: 하드코딩된 타입별 변환을 전략 패턴으로 리팩토링
    -   현재: `if (targetType === "choice")` 하드코딩 방식
    -   개선: BaseDialogue 공통 속성 기반 변환 전략 패턴 적용
    -   각 노드 타입별 변환 규칙을 독립적 전략으로 분리

#### 컴포넌트 분리

-   [ ] **PropertyPanel.tsx 분리**: UI 컴포넌트 과부하 해결
-   [ ] **App.tsx 분리**: 루트 컴포넌트 책임 분리
-   [ ] **Canvas.tsx 분리**: 캔버스 로직 세분화

#### 세부 최적화

-   [ ] **타입 정의 정리**: 중복/미사용 타입 정리
-   [ ] **상수 정의 중앙화**: 매직 넘버/문자열 constants 파일로 이동
-   [ ] **에러 메시지 코드화**: 콘솔 경고/에러 메시지 표준화
-   [ ] **빌드 최적화 및 번들 크기 최적화**
    -   Vite 빌드 설정 최적화
    -   번들 크기 분석 및 최적화
    -   로딩 성능 개선

---

## 📋 기술 정보 요약

### 아키텍처 핵심

-   **컨텐츠-키 분리**: 실제 텍스트(기획자) ↔ 로컬라이징 키(개발자) 완전 분리
-   **LocalizationStore**: 백그라운드 key-value 매핑 저장소
-   **의도적 키 관리**: 타이핑 중 키 생성 안함, 완료 시점에만 처리
-   **숫자 ID 기반 키**: `npc_1`, `line_1`, `choice_1` 형태로 충돌 방지

### 주요 레퍼런스

-   **PRD**: `document/prd.md` - 전체 프로젝트 사양 및 기술 스택
-   **Task Log**: `document/task-log.md` - 완료된 작업 요약
-   **기술 스택**: React + Vite + TypeScript, React Flow, Zustand, Tailwind CSS 4.x, Zod

---
