# 로컬라이제이션 데이터 조작 방식 및 테스트 케이스

## 📋 개요

세 페이지(에디터, Dialogue CSV, Localization CSV)에서 로컬라이제이션 데이터를 조작할 수 있는 모든 방식을 분석하고, 각각을 섞어서 테스트할 수 있는 상세한 테스트 케이스를 작성합니다.

---

## 🔧 로컬라이제이션 데이터 조작 방식

### **1. 에디터 페이지**

#### 1.1 노드 생성 시 자동 키 생성
- **동작**: 새 노드 생성 시 화자/내용 텍스트가 있으면 자동으로 키 생성
- **생성되는 키**: `npc_X` (화자), `line_X` (내용), `choice_X` (선택지)
- **위치**: Canvas에서 노드 추가

#### 1.2 Property Panel에서 텍스트 편집
- **동작**: 노드 선택 후 Property Panel에서 화자/내용 텍스트 편집
- **키 처리**: 기존 키 재사용 또는 새 키 생성
- **위치**: 우측 Property Panel

#### 1.3 키 편집 모달
- **동작**: Property Panel에서 키 편집 버튼 클릭 시 모달 열림
- **기능**: 키 변경, 텍스트 변경, 모든 위치에서 함께 변경 옵션
- **위치**: Property Panel → 키 편집 모달

#### 1.4 노드 삭제 시 키 정리
- **동작**: 노드 삭제 시 해당 노드가 사용하는 키가 다른 곳에서 사용되지 않으면 자동 삭제
- **위치**: Canvas에서 노드 삭제

### **2. Dialogue CSV 페이지**

#### 2.1 인라인 편집
- **동작**: 테이블에서 화자/내용 텍스트 직접 편집
- **키 처리**: `updateNodeText` 함수를 통해 키 생성/업데이트
- **위치**: Dialogue CSV 탭의 테이블

#### 2.2 CSV 복사
- **동작**: 현재 데이터를 CSV 형식으로 클립보드에 복사
- **포함 데이터**: 노드 구조, 키 참조, 실제 텍스트
- **위치**: Dialogue CSV 탭 상단 "CSV 복사" 버튼

### **3. Localization CSV 페이지**

#### 3.1 키-텍스트 인라인 편집
- **동작**: 테이블에서 키와 텍스트를 직접 편집
- **키 변경 시**: 해당 키를 사용하는 모든 노드의 키 참조 업데이트
- **텍스트 변경 시**: 해당 키를 사용하는 모든 노드의 실제 텍스트 업데이트
- **위치**: Localization CSV 탭의 테이블

#### 3.2 키 삭제
- **동작**: 키 삭제 시 경고 메시지 표시 후 해당 키를 사용하는 노드들의 텍스트와 키 참조 정리
- **위치**: Localization CSV 탭의 테이블 "삭제" 버튼

#### 3.3 검색 및 필터링
- **동작**: 키 또는 텍스트 기반 검색, 타입별 필터링
- **위치**: Localization CSV 탭 상단 검색/필터 영역

#### 3.4 CSV 복사
- **동작**: 현재 로컬라이제이션 데이터를 CSV 형식으로 클립보드에 복사
- **위치**: Localization CSV 탭 상단 "CSV 복사" 버튼

---

## 🧪 테스트 케이스

### **TC-01: 기본 동기화 테스트**

**목적**: 세 페이지 간 기본적인 데이터 동기화 확인

**테스트 단계**:
1. 에디터에서 새 텍스트 노드 생성 (화자: "NPC", 내용: "안녕하세요")
2. Dialogue CSV 탭으로 전환하여 데이터 확인
3. Localization CSV 탭으로 전환하여 키-텍스트 매핑 확인
4. 에디터로 돌아가서 노드 선택 후 Property Panel 확인

**예상 결과**:
- ✅ 에디터: 노드에 "NPC", "안녕하세요" 표시
- ✅ Dialogue CSV: 화자 "NPC", 내용 "안녕하세요" 표시
- ✅ Localization CSV: `npc_1: "NPC"`, `line_1: "안녕하세요"` 표시
- ✅ Property Panel: 화자/내용 텍스트와 키 참조 표시

---

### **TC-02: 에디터 → Dialogue CSV 동기화**

**목적**: 에디터에서 변경한 내용이 Dialogue CSV에 반영되는지 확인

**테스트 단계**:
1. 에디터에서 기존 노드의 Property Panel에서 화자 텍스트를 "새로운 화자"로 변경
2. Dialogue CSV 탭으로 전환
3. 해당 노드의 화자 텍스트 확인

**예상 결과**:
- ✅ Dialogue CSV에서 화자 텍스트가 "새로운 화자"로 업데이트됨
- ✅ Localization CSV에서 새로운 키가 생성되거나 기존 키가 업데이트됨

---

### **TC-03: Dialogue CSV → 에디터 동기화**

**목적**: Dialogue CSV에서 변경한 내용이 에디터에 반영되는지 확인

**테스트 단계**:
1. Dialogue CSV 탭에서 노드의 내용 텍스트를 "새로운 내용입니다"로 편집
2. 에디터 탭으로 전환
3. 해당 노드의 내용 텍스트 확인

**예상 결과**:
- ✅ 에디터에서 노드 내용이 "새로운 내용입니다"로 업데이트됨
- ✅ Property Panel에서 내용 텍스트와 키 참조가 업데이트됨

---

### **TC-04: Localization CSV 키 변경 → 전체 동기화**

**목적**: Localization CSV에서 키를 변경했을 때 모든 페이지에 반영되는지 확인

**테스트 단계**:
1. Localization CSV 탭에서 `npc_1` 키를 `npc_new`로 변경
2. 에디터 탭으로 전환하여 노드 확인
3. Dialogue CSV 탭으로 전환하여 키 참조 확인
4. Property Panel에서 키 참조 확인

**예상 결과**:
- ✅ 에디터: 노드 화자 텍스트는 그대로 유지
- ✅ Dialogue CSV: 화자 키가 `npc_new`로 업데이트됨
- ✅ Property Panel: 화자 키 참조가 `npc_new`로 업데이트됨

---

### **TC-05: Localization CSV 텍스트 변경 → 전체 동기화**

**목적**: Localization CSV에서 텍스트를 변경했을 때 모든 페이지에 반영되는지 확인

**테스트 단계**:
1. Localization CSV 탭에서 `line_1`의 텍스트를 "변경된 내용"으로 수정
2. 에디터 탭으로 전환하여 노드 내용 확인
3. Dialogue CSV 탭으로 전환하여 내용 텍스트 확인

**예상 결과**:
- ✅ 에디터: 노드 내용이 "변경된 내용"으로 업데이트됨
- ✅ Dialogue CSV: 내용 텍스트가 "변경된 내용"으로 업데이트됨
- ✅ Property Panel: 내용 텍스트가 "변경된 내용"으로 업데이트됨

---

### **TC-06: 키 삭제 → 전체 정리**

**목적**: Localization CSV에서 키를 삭제했을 때 모든 페이지에서 정리되는지 확인

**테스트 단계**:
1. Localization CSV 탭에서 `npc_1` 키의 "삭제" 버튼 클릭
2. 경고 메시지 확인 후 "확인" 클릭
3. 에디터 탭으로 전환하여 노드 확인
4. Dialogue CSV 탭으로 전환하여 데이터 확인

**예상 결과**:
- ✅ 경고 메시지에 영향받는 노드 목록 표시
- ✅ 에디터: 노드 화자 텍스트가 비워짐
- ✅ Dialogue CSV: 화자 텍스트가 비워지고 키 참조 제거됨
- ✅ Localization CSV: 해당 키가 삭제됨

---

### **TC-07: 복합 시나리오 - 순차적 편집**

**목적**: 여러 페이지에서 순차적으로 편집했을 때 데이터 일관성 확인

**테스트 단계**:
1. 에디터에서 노드 내용을 "첫 번째 편집"으로 변경
2. Dialogue CSV에서 같은 노드의 내용을 "두 번째 편집"으로 변경
3. Localization CSV에서 해당 키의 텍스트를 "세 번째 편집"으로 변경
4. 에디터로 돌아가서 최종 상태 확인

**예상 결과**:
- ✅ 최종적으로 모든 페이지에서 "세 번째 편집"으로 통일됨
- ✅ 키 참조가 일관되게 유지됨

---

### **TC-08: 중복 텍스트 처리**

**목적**: 동일한 텍스트가 있을 때 키 재사용이 올바르게 동작하는지 확인

**테스트 단계**:
1. 에디터에서 노드 A의 내용을 "공통 텍스트"로 설정
2. 에디터에서 노드 B의 내용을 "공통 텍스트"로 설정
3. Localization CSV 탭으로 전환하여 키 확인
4. Dialogue CSV 탭으로 전환하여 키 참조 확인

**예상 결과**:
- ✅ Localization CSV에서 "공통 텍스트"에 대한 키가 하나만 생성됨
- ✅ Dialogue CSV에서 두 노드 모두 같은 키를 참조함
- ✅ Property Panel에서 두 노드 모두 같은 키 참조를 표시함

---

### **TC-09: 선택지 노드 동기화**

**목적**: 선택지 노드의 로컬라이제이션 데이터 동기화 확인

**테스트 단계**:
1. 에디터에서 선택지 노드 생성 (선택지: "예", "아니오")
2. Dialogue CSV 탭으로 전환하여 선택지 정보 확인
3. Localization CSV 탭으로 전환하여 선택지 키 확인
4. Localization CSV에서 선택지 텍스트 변경
5. 에디터로 돌아가서 선택지 확인

**예상 결과**:
- ✅ 선택지 텍스트가 모든 페이지에서 동기화됨
- ✅ 선택지 키가 올바르게 생성되고 참조됨

---

### **TC-10: 빈 텍스트 처리**

**목적**: 빈 텍스트로 변경했을 때 키 참조가 올바르게 정리되는지 확인

**테스트 단계**:
1. 에디터에서 노드의 내용을 "테스트 텍스트"로 설정
2. Property Panel에서 내용을 빈 문자열로 변경
3. Localization CSV 탭으로 전환하여 키 상태 확인
4. Dialogue CSV 탭으로 전환하여 데이터 확인

**예상 결과**:
- ✅ Localization CSV에서 해당 키가 삭제되거나 빈 값으로 설정됨
- ✅ Dialogue CSV에서 키 참조가 제거됨
- ✅ Property Panel에서 키 참조가 제거됨

---

### **TC-11: 검색 및 필터링 기능**

**목적**: Localization CSV의 검색 및 필터링 기능 확인

**테스트 단계**:
1. Localization CSV 탭에서 검색창에 "npc" 입력
2. 필터 드롭다운에서 "화자 키" 선택
3. 검색 결과 확인
4. 검색 조건 변경 후 결과 확인

**예상 결과**:
- ✅ 검색어에 맞는 키들만 표시됨
- ✅ 필터 조건에 맞는 키들만 표시됨
- ✅ 검색 결과 개수가 올바르게 표시됨

---

### **TC-12: CSV 복사 기능**

**목적**: 각 페이지의 CSV 복사 기능 확인

**테스트 단계**:
1. Dialogue CSV 탭에서 "CSV 복사" 버튼 클릭
2. 클립보드 내용 확인
3. Localization CSV 탭에서 "CSV 복사" 버튼 클릭
4. 클립보드 내용 확인

**예상 결과**:
- ✅ Dialogue CSV: 노드 구조, 키 참조, 실제 텍스트가 포함된 CSV
- ✅ Localization CSV: 키-텍스트 매핑이 포함된 CSV
- ✅ CSV 형식이 올바르게 생성됨

---

### **TC-13: 탭 전환 시 편집 상태 처리**

**목적**: 편집 중인 상태에서 탭을 전환할 때 경고 및 처리 확인

**테스트 단계**:
1. Dialogue CSV 탭에서 노드 편집 시작
2. Localization CSV 탭으로 전환 시도
3. 경고 메시지 확인 후 "계속" 클릭
4. 편집 상태 확인

**예상 결과**:
- ✅ 편집 중인 상태에서 탭 전환 시 경고 메시지 표시
- ✅ "계속" 클릭 시 편집 상태가 초기화됨
- ✅ 탭 전환 후 새로운 탭에서 정상 동작

---

### **TC-14: 되돌리기 기능**

**목적**: Ctrl+Z 단축키와 "모두 취소" 버튼 기능 확인

**테스트 단계**:
1. Dialogue CSV 탭에서 여러 노드 편집
2. Localization CSV 탭에서 키/텍스트 편집
3. Ctrl+Z 단축키 사용
4. "모두 취소" 버튼 클릭

**예상 결과**:
- ✅ Ctrl+Z로 편집 상태가 취소됨
- ✅ "모두 취소" 버튼으로 모든 편집 상태가 초기화됨
- ✅ 토스트 메시지로 취소 상태 알림

---

### **TC-15: 유효성 검사**

**목적**: 중복 키, 중복 텍스트, 빈 값 검사 기능 확인

**테스트 단계**:
1. Localization CSV 탭에서 "유효성 검사" 버튼 클릭
2. 중복 키가 있는 상황에서 검사 실행
3. 중복 텍스트가 있는 상황에서 검사 실행
4. 빈 값이 있는 상황에서 검사 실행

**예상 결과**:
- ✅ 중복 키 발견 시 경고 메시지 표시
- ✅ 중복 텍스트 발견 시 경고 메시지 표시
- ✅ 빈 값 발견 시 경고 메시지 표시
- ✅ 문제가 없을 때 "문제 없음" 메시지 표시

---

## 📊 테스트 실행 체크리스트

### **기본 동기화 테스트**
- [ ] TC-01: 기본 동기화 테스트
- [ ] TC-02: 에디터 → Dialogue CSV 동기화
- [ ] TC-03: Dialogue CSV → 에디터 동기화
- [ ] TC-04: Localization CSV 키 변경 → 전체 동기화
- [ ] TC-05: Localization CSV 텍스트 변경 → 전체 동기화

### **고급 기능 테스트**
- [ ] TC-06: 키 삭제 → 전체 정리
- [ ] TC-07: 복합 시나리오 - 순차적 편집
- [ ] TC-08: 중복 텍스트 처리
- [ ] TC-09: 선택지 노드 동기화
- [ ] TC-10: 빈 텍스트 처리

### **UI/UX 기능 테스트**
- [ ] TC-11: 검색 및 필터링 기능
- [ ] TC-12: CSV 복사 기능
- [ ] TC-13: 탭 전환 시 편집 상태 처리
- [ ] TC-14: 되돌리기 기능
- [ ] TC-15: 유효성 검사

---

## 🎯 테스트 실행 가이드

### **테스트 환경 준비**
1. 브라우저 개발자 도구 열기 (F12)
2. Console 탭에서 로그 확인 준비
3. 여러 노드가 있는 프로젝트 로드

### **테스트 실행 순서**
1. 기본 동기화 테스트부터 시작
2. 각 테스트 후 다른 페이지로 전환하여 동기화 확인
3. 콘솔 로그를 통해 데이터 흐름 추적
4. 예상 결과와 실제 결과 비교

### **문제 발견 시**
1. 콘솔 로그 확인
2. 스크린샷 캡처
3. 재현 단계 기록
4. 버그 리포트 작성

---

## 📝 테스트 결과 기록

### **테스트 실행 일자**: _______________
### **테스트 실행자**: _______________

### **통과한 테스트**
- [ ] TC-01: _______________
- [ ] TC-02: _______________
- [ ] TC-03: _______________
...

### **실패한 테스트**
- [ ] TC-XX: _______________
  - **문제**: _______________
  - **재현 단계**: _______________
  - **예상 결과**: _______________
  - **실제 결과**: _______________

### **발견된 버그**
1. **버그 1**: _______________
   - **심각도**: High/Medium/Low
   - **영향 범위**: _______________
   - **해결 방법**: _______________

### **개선 제안**
1. **개선사항 1**: _______________
   - **현재 상태**: _______________
   - **개선 방향**: _______________
   - **우선순위**: High/Medium/Low 