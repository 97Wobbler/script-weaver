# 키 편집 UI 개선 - QA 테스트 케이스

## 📋 테스트 환경 준비
1. 브라우저 새로고침으로 초기 상태 시작
2. localStorage 초기화 (개발자 도구에서 `localStorage.clear()`)

---

## 🧪 Phase 1: 키 편집 UI 단순화 테스트

### TC-P1-01: 키 편집 모달 UI 확인
**전제조건**: 최소 2개 이상의 노드가 같은 텍스트를 사용하는 상황
**절차**:
1. 텍스트 노드 2개 생성
2. 첫 번째 노드 화자를 "김철수"로 입력
3. 두 번째 노드 화자도 "김철수"로 입력 (같은 키 재사용됨)
4. 첫 번째 노드 선택 후 화자 키(`npc_1`) 클릭
5. 키 편집 모달이 열리는지 확인

**예상 결과**:
- ✅ "새 키로 분리" 버튼이 없어야 함
- ✅ "모든 위치 함께 변경 (2개 위치)" 버튼만 표시
- ✅ 사용 현황에 2개 위치 표시

### TC-P1-02: 단일 사용 키의 키 편집 모달
**절차**:
1. 텍스트 노드 1개 생성
2. 화자를 "단독화자"로 입력
3. 화자 키 클릭하여 키 편집 모달 열기

**예상 결과**:
- ✅ "변경 적용" 버튼 표시 (개수 표시 없음)
- ✅ 사용 현황에 1개 위치 표시

---

## 🧪 Phase 2: 스마트 텍스트 관리 테스트

### TC-P2-01: 단일 사용 키의 텍스트 변경 (기존 키 유지)
**절차**:
1. 텍스트 노드 1개 생성
2. 화자를 "원래화자"로 입력 → 키 `npc_1` 생성됨
3. 속성 패널에서 화자를 "변경화자"로 수정
4. Enter 또는 포커스 아웃

**예상 결과**:
- ✅ 키는 여전히 `npc_1`이어야 함
- ✅ 키 옆에 "(1개 사용)" 표시
- ✅ 중복 텍스트 모달이 뜨지 않아야 함

### TC-P2-02: 다중 사용 키의 텍스트 변경 (새 키 생성)
**절차**:
1. 텍스트 노드 2개 생성
2. 두 노드 모두 화자를 "공통화자"로 입력 → 키 `npc_1` 공유
3. 첫 번째 노드 선택
4. 속성 패널에서 화자를 "개별화자"로 수정
5. Enter 또는 포커스 아웃

**예상 결과**:
- ✅ 첫 번째 노드의 키가 `npc_2`로 변경됨
- ✅ 두 번째 노드는 여전히 `npc_1` 유지
- ✅ 중복 텍스트 모달이 뜨지 않아야 함

### TC-P2-03: 중복 텍스트 입력 시 사용자 선택 모달
**절차**:
1. 텍스트 노드 2개 생성
2. 첫 번째 노드 화자를 "기존화자"로 입력 → 키 `npc_1`
3. 두 번째 노드 화자를 "다른화자"로 입력 → 키 `npc_2`
4. 두 번째 노드에서 화자를 "기존화자"로 변경 (중복)
5. Enter 또는 포커스 아웃

**예상 결과**:
- ✅ 중복 텍스트 확인 모달이 열려야 함
- ✅ "기존 키 사용하기 (npc_1)" 버튼 표시
- ✅ "새 키 생성하기" 버튼 표시
- ✅ "취소" 버튼 표시

### TC-P2-04: 중복 텍스트 모달 - 기존 키 사용 선택
**전제조건**: TC-P2-03 상황에서 계속
**절차**:
1. "기존 키 사용하기 (npc_1)" 버튼 클릭

**예상 결과**:
- ✅ 두 번째 노드의 키가 `npc_1`로 변경됨
- ✅ 두 노드 모두 같은 키 공유
- ✅ 두 노드 모두 "(2개 사용)" 표시

### TC-P2-05: 중복 텍스트 모달 - 새 키 생성 선택
**절차**:
1. TC-P2-03 상황 재현
2. "새 키 생성하기" 버튼 클릭

**예상 결과**:
- ✅ 두 번째 노드의 키가 `npc_3`로 생성됨
- ✅ 첫 번째 노드는 `npc_1` 유지
- ✅ 각각 "(1개 사용)" 표시

### TC-P2-06: 중복 텍스트 모달 - 취소 선택
**절차**:
1. TC-P2-03 상황 재현
2. "취소" 버튼 클릭

**예상 결과**:
- ✅ 모달이 닫힘
- ✅ 텍스트가 원래대로 복원됨
- ✅ 키 변경사항 없음

---

## 🧪 Phase 3: 선택지 텍스트 관리 테스트

### TC-P3-01: 선택지 단일 사용 키 텍스트 변경
**절차**:
1. 선택지 노드 1개 생성
2. 선택지 추가하여 "원래선택지"로 입력 → 키 `choice_1`
3. 선택지 텍스트를 "변경선택지"로 수정

**예상 결과**:
- ✅ 키는 여전히 `choice_1`이어야 함
- ✅ 키 옆에 "(1개 사용)" 표시

### TC-P3-02: 선택지 중복 텍스트 처리
**절차**:
1. 선택지 노드 2개 생성
2. 첫 번째 노드에 "공통선택지" 선택지 추가 → 키 `choice_1`
3. 두 번째 노드에 "다른선택지" 선택지 추가 → 키 `choice_2`
4. 두 번째 노드의 선택지를 "공통선택지"로 변경

**예상 결과**:
- ✅ 중복 텍스트 확인 모달이 열려야 함
- ✅ 기존 키 사용/새 키 생성 선택 가능

---

## 🧪 IME 처리 테스트 (한국어 입력)

### TC-IME-01: 한국어 입력 중 키 생성 방지
**절차**:
1. 텍스트 노드 생성
2. 화자 필드에 한국어 "안녕하세요" 천천히 입력
3. 입력 중간에 다른 곳 클릭하지 말고 완전히 입력 완료
4. Enter 또는 포커스 아웃

**예상 결과**:
- ✅ 글자 반복 현상 없음
- ✅ "안녕하세요" 정확히 입력됨
- ✅ 키 생성이 완료 시점에만 발생

### TC-IME-02: 한국어 입력 중 중간 포커스 아웃
**절차**:
1. 텍스트 노드 생성
2. 화자 필드에 "안녕하"까지만 입력 (미완성 상태)
3. 다른 곳 클릭하여 포커스 아웃

**예상 결과**:
- ✅ IME 상태 확인하여 키 생성 안함
- ✅ 입력 중인 텍스트 보존

---

## 🧪 키 편집 모달 기능 테스트

### TC-KEY-01: 키 편집 모달에서 텍스트+키 동시 변경
**절차**:
1. 다중 사용 키 상황 생성 (2개 노드가 같은 화자 공유)
2. 키 클릭하여 편집 모달 열기
3. 텍스트 내용을 "새로운화자"로 변경
4. 키 값을 "custom_speaker"로 변경
5. "모든 위치 함께 변경" 버튼 클릭

**예상 결과**:
- ✅ 두 노드 모두 키가 "custom_speaker"로 변경됨
- ✅ 두 노드 모두 텍스트가 "새로운화자"로 변경됨
- ✅ 기존 키는 삭제됨

### TC-KEY-02: 키 편집 모달에서 텍스트만 변경
**절차**:
1. 다중 사용 키 상황 생성
2. 키 편집 모달에서 텍스트만 "수정된텍스트"로 변경
3. 키 값은 그대로 유지
4. "모든 위치 함께 변경" 버튼 클릭

**예상 결과**:
- ✅ 기존 키 유지됨
- ✅ 두 노드 모두 텍스트가 "수정된텍스트"로 변경됨

---

## 🧪 엣지 케이스 테스트

### TC-EDGE-01: 빈 텍스트 입력
**절차**:
1. 텍스트 노드 생성하여 화자 입력
2. 화자 텍스트를 모두 지워서 빈 문자열로 만들기
3. Enter 또는 포커스 아웃

**예상 결과**:
- ✅ 기존 키가 삭제됨
- ✅ 키 표시 영역이 사라짐

### TC-EDGE-02: 공백만 있는 텍스트 입력
**절차**:
1. 텍스트 노드 생성
2. 화자에 "   " (공백만) 입력
3. Enter 또는 포커스 아웃

**예상 결과**:
- ✅ 빈 텍스트로 처리되어 키 생성 안됨

---

## ✅ 회귀 테스트 (기존 기능 확인)

### TC-REG-01: 기본 노드 생성
**절차**:
1. "텍스트 노드 추가" 버튼 클릭
2. "선택지 노드 추가" 버튼 클릭

**예상 결과**:
- ✅ 노드가 빈 텍스트로 생성됨 (기본값 없음)
- ✅ 키가 즉시 생성되지 않음

### TC-REG-02: 노드 연결
**절차**:
1. 텍스트 노드 2개 생성
2. 첫 번째 노드의 출력 핸들을 두 번째 노드의 입력 핸들에 연결

**예상 결과**:
- ✅ 연결선이 정상적으로 그어짐
- ✅ 첫 번째 노드의 nextNodeKey가 설정됨

### TC-REG-03: Export/Import
**절차**:
1. 여러 노드 생성하고 텍스트 입력
2. JSON으로 Export
3. 새 탭에서 Import

**예상 결과**:
- ✅ 모든 노드와 텍스트가 정상적으로 복원됨
- ✅ 키 관계가 정상적으로 유지됨

---

## 📝 테스트 결과 기록 양식

각 테스트 케이스에 대해 다음과 같이 기록해주세요:

```
TC-P1-01: ✅ PASS / ❌ FAIL
- 실제 결과: 
- 문제점 (FAIL인 경우):
- 스크린샷 (필요시):

TC-P1-02: ✅ PASS / ❌ FAIL
...
```

## 🚨 우선순위 높은 테스트

1. **TC-P2-01~TC-P2-06**: 스마트 텍스트 관리 핵심 기능
2. **TC-P1-01~TC-P1-02**: UI 단순화 확인  
3. **TC-IME-01**: 한국어 입력 문제 해결 확인
4. **TC-P3-01~TC-P3-02**: 선택지 처리
5. **TC-KEY-01~TC-KEY-02**: 키 편집 모달 기능

나머지는 시간이 허락할 때 추가로 테스트해주세요! 